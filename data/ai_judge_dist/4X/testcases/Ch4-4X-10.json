{
  "4.1": {
    "(1)": "证明：\n$$G_n-3G_{n-1}+G_{n-2} \\\\ = F_{2n}-3F_{2n-2}+F_{2n-4} \\\\ = (F_{2n-1} + F_{2n-2}) - 3F_{2n-2}+F_{2n-4} \\\\ = F_{2n-2} + F_{2n-3} - 2 F_{2n-2} + F_{2n-4} \\\\ = (F_{2n-3} + F_{2n-4}) - F_{2n-2} \\\\ = 0$$",
    "(2)": "$\\{G_n\\}$ 的母函数：\n $T(x) = G_0 + G_1x + G_2x^2 + ... = \\sum_{n=0}^{\\infty}G_nx^n$\n $-3xT(x)=0+-3G_0x-3G_1x^2 -3G_2x^3 ...$\n $x^2T(x)=0 + 0 + G_0x^2 + G_1x^3 + ...$\n 将上述三个等式加到一起：\n $(1-3x+x^2)T(x) = G_0+(G_1-3G_0)x = x$\n 因此有 $T_(x) = \\frac{x}{1-3x+x^2}$"
  },
  "4.2": {
    "(1)": "设该母函数为 $A(x)=\\frac{1}{1-x+x^2}$\n 有 $(1-x+x^2)A(x)=1$\n 同样有：\n $A(x)=a_0+a_1x+a_2x^2+a_3x^3 + ...$\n $-xA(x)=-a_0x-a_1x^2-a_2x^3-a_3x^4 + ...$\n $x^2A(x)=a_0x^2+a_1x^3+a_2x^4+a_3x^5 + ...$\n $(1-x+x^2)a(x) = a_0 + (a_1-a_0)x + (a_2-a_1+a_0)x^2 + ...$\n 对比可知：\n $a_k-a_{k-1}+a_{k-2} = 0, a_0=1, a_1=a_0=1$"
  },
  "4.3": {
    "(1)": "假设其为二阶递推关系：\n $a_{n+2} =c * 3^{n+2} + d * (-1)^n$\n $S a_{n+1}=Sc * 3^{n+1} + Sd * (-1)^{n+1}$\n $Ta_n=Tc * 3^n + Td * (-1)^n$\n 联立 $a_{n+2}=Sa_{n+1}+Ta_n$\n 则有 $9=3S+T, 1=T-S$\n 解得 $S=2, T=3$\n 因此有 $a_{n+2}=2a_{n+1}+3a_n$"
  },
  "4.4": {
    "(1)": "差分法：\n $a_n-2a_{n-1}+a_{n-2}=5$\n $a_{n-1}-2a_{n-2}+a_{n-3}=5$\n 做差：\n $a_n-3a_{n-1}+3a_{n-2}-a_{n-3} = 0$\n 特征多项式：$x^3-3x^2+3x-1 = (x-1)^3$\n 由于有 3 重实根，\n $a_n = ( A_0 + A_1n + A_2n^2 ) * 1^n$\n 带入：$a_0 = 1, a_1 = 2, a_2=8$\n 计算得：$a_n=1-\\frac{3}{2}n+\\frac{5}{2}n^2$"
  },
  "4.5": {
    "(1)": "先计算 AB 一次都不出现的长度为 n 字符串数目，记之为数列 $a_n$.\n $a_n$ 可以从 $a_{n-1}$ 转移：考虑从长度为 n-1 的无 AB 字符串转移。\n 对于所有长度为 n-1 的无 AB 字符串，在后面可以添加 A/B/C/D，以获得长度为 n，且前 n-1 个字符没有 AB 的字符串数量：$4a_{n-1}$.\n 显然 $4a_{n-1}$ 多了一些，多的字符串为长度为 n，前n-2个字符没有 AB 的字符串，其数量为 $a_{n-2}$.\n 因此有：$a_n=4a_{n-1}-a_{n-2}$\n 特征多项式为 $x^2-4x+1=0$\n 两个特征根 $x_1=2+\\sqrt{3}, x_2=2-\\sqrt{3}$\n 因此 $a_n=A(2+\\sqrt{3})^n+B(2-\\sqrt{3})^n$\n 带入 $a_1=4, a_2=15$\n 可以解得 $A=\\frac{2+\\sqrt{3}}{2\\sqrt{3}},B =-\\frac{2-\\sqrt{3}}{2\\sqrt{3}}$\n $a_n=\\frac1{2\\sqrt{3}}\\Big[(2+\\sqrt{3})^{n+1}-(2-\\sqrt{3})^{n+1}\\Big]$\n 原问题答案为 $4^n-\\frac1{2\\sqrt{3}}\\Big[(2+\\sqrt{3})^{n+1}-(2-\\sqrt{3})^{n+1}\\Big]$"
  },
  "4.6": {
    "(1)": "不妨设 n 为偶数。\n 原汉诺塔问题的最小次数为 $h_n=2^n-1$, 新问题的最小次数数列为 $F_n$.\n 寻找该任务的子结构：\n - 为了完成移动 n 个盘子，需要先将最大的 n 号盘子移动到 B 上\n - 因此需要：\n   - 现将盘子全部移动到 C 上，需要 $h_{n-1}$\n   - 将 n 号盘子从 A 移动到 B 上，需要 1 次\n   - 此时 n-1 号盘子也在 C 上\n - 此时子问题结构没有完全回归，再考虑将 n-2 号盘子移动到 B 上的需求\n   - 需要将 C 上的 n-3 个盘子移动到 A 上，需要 $h_{n-3}$ \n   - 将 n-2 号盘子从 C 移动到 B 上，需要一次\n   - 此时剩下的 n-3 个盘子在 A 上，n, n-2 号盘子在 B 上，n-1 号盘子在 C 上，为相同结构\n 因此可得递推关系 \n $$F_n=(h_{n-1}+1)+(h_{n-3}+1)+F_{n-3} \\\\ = 5*2^{n-3} + F_{n-3}$$\n 差分法：\n $F_{n-1}=5*2^{n-4}+F_{n-4}$\n 可得：\n $F_n-F_{n-3}=2(F_{n-1}-F_{n-4})$\n 对应的特征方程：\n $x^4-2x^3-x+2 = (x-2)(x^3-1)=0$\n 特征根：\n $x_1 = 1, \\quad x_2 = 2, \\quad x_3, x_4 = e^{\\pm \\frac{2}{3} \\pi i}$\n 通解为：\n$F_n = A 2^n + B + C \\cos\\left(\\frac{2}{3} \\pi n\\right) + D \\sin\\left(\\frac{2}{3} \\pi n\\right)$\n 代入特解：\n$F_0 &= 0 \\\\ F_1 &= 1 \\\\ F_2 &= 2 \\\\ F_3 &= 5 \\\\$ \n 解得答案为：\n$F_n = \\frac{5}{7} 2^n - \\frac{2}{3} - \\frac{1}{21} \\cos\\left(\\frac{2}{3} \\pi n\\right) + \\frac{\\sqrt{3}}{7} \\sin\\left(\\frac{2}{3} \\pi n\\right)$"
  },
  "4.7": {
    "(1)": "设满足条件的长度为 n 个字符串有 $F_n$ 个\n 将满足条件的长度为 n 的字符串 s 分为不相交的两种：\n - 最后一个字母与倒数第二个字母不同的：这种字符串只需在所有满足条件的长度为 n-1 的字符串后添加一个不同的字母，因此有 $(k-1)F_{n-1}$ 个\n - 最后一个字母与倒数第二个字母相同的：这种字符串只需在所有满足条件的长度为 n-2 的字符串后添加2个与倒数第三个字母不同的字母，因此有 $(k-1)F_{n-2}$ 个\n 因此有 $F_n = (k-1)(F_{n-1} + F_{n-2})$\n 特征方程：\n $x^2-(k-1)x-(k-1) = 0$\n $x_{1}=\\frac k2-\\frac{\\sqrt{(k-1)(k+3)}}2-\\frac12\\\\x_{2}=\\frac k2+\\frac{\\sqrt{(k-1)(k+3)}}2-\\frac12$\n 带入 $F_1=k, F_2=k^2$"
  },
  "4.8": {
    "(1)": "记 $S_n=\\sum_{k=1}^{n}k^4$\n ### 第0次差分\n $\\delta S_n = S_n - S_{n-1} = n^4$\n ### 第1次差分\n $S_n - S_{n-1} = n^4$\n $S_{n-2}-S_{n-3}=(n-1)^4$\n $S_{n}-S_{n-1}-S_{n-2}+S_{n-3}=n^4-(n-1)^4=4n^3-6n^2+4n-1$\n ### ...\n 在 6 次差分之后，获得特征方程 $(x-1)^6=0$, 有6重根。\n 因此解的形式为：\n $S_n=A_0+A_1n+A_2n^2+A_3n^3+A_4n^4+A_5n^5$\n 带入：\n $S_1=1,\\quad S_2=16+1=17,\\quad S_3=81+17=98,\\quad S_4=256+98=354,\\quad S_5=625+324=979$\n 解得：\n $S_n=\\frac15n^5+\\frac12n^4+\\frac13n^3-\\frac1{30}n$"
  },
  "4.9": {
    "(1)": "将问题，从 1~n 的正整数中选取 k 个不相邻的数，分为两种情况：\n - 不选取 n，方案数为 $f(n-1, k)$\n - 选取 n，则 n-1 不能被选取，方案数为 $f(n-2,k-1)$\n 因此有 $f(n,k) = f(n-1, k) + f(n-2,k-1)$",
    "(2)": "证明：$f(n,k) = \\binom{n-k+1}{k}$\n 归纳假设：假设对于 $m<n$ 的情况 $f(m,k) = \\binom{m-k+1}{k}$ 均成立。\n 由递推关系：\n $f(n,k) = f(n-1, k) + f(n-2,k-1)$\n  = $\\binom{n-1-k+1}{k} + \\binom{n-2-(k-1)+1}{k-1}$\n  = $\\binom{n-k}{k} + \\binom{n-k}{k-1}$\n 由组合数性质，上述加式正是 $\\binom{n-k+1}{k}$，因此根据数学归纳法，归纳递推成立。\n 原命题得证。",
    "(3)": "在新的限制条件下，$f(n,k)$ 会计算同时选取 1 和 n 的情况，比 $g(n,k)$ 稍多。\n 因此我们只需从 $f(n,k)$ 减去同时选取了 1 和 n 的特殊情况。\n 在限制下，同时选取 1 和 n，那么 2 和 n-1 不能选，因此情况数为 $f(n-4, k-2)$\n 带入上一题的表达式，$g(n,k)=f(n,k)-f(n-4,k-2)=\\binom{n-k+1}{k}-\\binom{n-k-1}{k-2}$"
  },
  "4.10": {
    "(1)": "设长度为 n 的路径的铺砖方案数为 $F_n$.\n 根据末尾的砖的种类分类计算：\n - 最后一块砖为方砖：$F_{n-1}$\n - 最后的砖为两个直角边长为 1 的等腰直角三角形砖，这里应该有 $4F_{n-1}$\n   - 注：因为两个直角边长为 1 的等腰直角三角形砖铺 1x1 的格，可以在格内旋转\n - 最后的砖为一块斜边长为2的等腰直角三角形砖 + 2块直角边长为 1 的等腰直角三角形砖，有$2F_{n-2}$\n 因此有递推关系：\n $F_n = 5F_{n-1} + 2F_{n-2}$\n 特征多项式为 $x^2-5x-2=0$\n 特征根为：\n $x1=\\frac{5+\\sqrt{33}}{2}, x2=\\frac{5-\\sqrt{33}}{2}$\n 因此 $F_n=A(\\frac{5+\\sqrt{33}}{2})^n + B(\\frac{5-\\sqrt{33}}{2})^n$\n 带入 $F_1=5,F_2=5*5+2=27$\n 则有\n $F_n = \\left( \\frac{\\sqrt{33} + 5}{2\\sqrt{33}} \\right) \\left( \\frac{5 + \\sqrt{33}}{2} \\right)^n + \\left( \\frac{\\sqrt{33} - 5}{2\\sqrt{33}} \\right) \\left( \\frac{5 - \\sqrt{33}}{2} \\right)^n$",
    "(2)": "设长度为 n 的路径的铺砖方案中砖数总和为 $G_n$.\n 根据末尾的砖的种类分类计算：\n - 最后一块砖为方砖：$G_{n-1}+F_{n-1}$\n - 最后的砖为两个直角边长为 1 的等腰直角三角形砖：$4G_{n-1}+4*2*F_{n-2}$\n - 最后的砖为一块斜边长为2的等腰直角三角形砖 + 2块直角边长为 1 的等腰直角三角形砖：\n   - $2G_{n-2}+2*3*F_{n-2}$\n 因此该递推关系为 $G_n=5G_{n-1}+2G_{n-2}+F_{n-1}+14F_{n-2}$\n 其中 $G_1=9$ \n $G_2=3*2(斜边为2+2直边为1)+3*8*(1方砖+2直边为1) + 4*16(4直边为1) + 2*1(两方砖)\\\\=96$"
  }
}
