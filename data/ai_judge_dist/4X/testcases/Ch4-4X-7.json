{
    "4.1": {
        "(1)": "因$F_n = F_{n-2} + F_{n-1} $，$G_n = F_{2n}$可以推导出：$$G_n = F_{2n} = F_{2n-2} + F_{2n-1} \\\\= 2F_{2n-2} + F_{2n-3} \\\\= 2F_{2n-2} + F_{2n-2} - F_{2n-4} = 3F_{2n-2} - F_{2n-4}$$ 因$G_{n-1} = F_{2n-2}$，$G_{n-2} = F_{2n-4}$，可知：$$G_n = 3G_{n-1} - G_{n-2}\\\\ G_n - 3G_{n-1} + G_{n-2} = 0$$",
        "(2)": "由递推关系可知，特征多项式为$C(x) = x^2 - 3x + 1 = 0$，解得$\\alpha_1 = (3+\\sqrt{5})/2,\\alpha_2 = (3-\\sqrt{5})/2 $。设母函数为$$ G(x) = \\frac{l_1}{1-\\alpha_1x} + \\frac{l_2}{1-\\alpha_2x} $$则$G_n = l_1\\alpha_1^n + l_2\\alpha_2^n$。由$F_0 = 0, F_1 = 1, F_2 = 1$可知$G_0 = 0, G_1 = 1$，联立方程组得：$$\\left\\{\\begin{aligned}l_1 + l_2 = 0\\\\ l_1(3+\\sqrt{5})/2 + l_2(3-\\sqrt{5})/2 = 1\\end{aligned}\\right.$$解得$l_1 = \\sqrt{5}/5, l_2 = -\\sqrt{5}/5$，母函数为：$$ G(x) = -\\frac{3\\sqrt{5}x}{5-15x+5x^2}$$"
    },
    "4.2": {
        "(1)": "特征多项式为$ C(x) = x^2 -x +1$，得到二阶常系数递推式$a_n - a_{n-1} + a_{n-2} = 0$。利用母函数的长除法，得到母函数为$1 + x - x^3 - ...$，根据1和x的系数可知，$a_0 = 1, a_1 = 1$"
    },
    "4.3": {
        "(1)": "由$a_n$的通项公式可知，特征多项式的解为3和-1，得到特征多项式为$(x-3)(x+1) = 0$，即为$x^2 - 2x -3 = 0$，由此可知，$\\{a_n\\}$的线性常系数递推关系为$a_n - 2a_{n-1} - 3a_{n-2} = 0$"
    },
    "4.4": {
        "(1)": "将题目中给出的公式转换为齐次递推式：$$ a_n - 2a_{n-1} + a_{n-2} = 5 \\\\ a_{n-1} - 2a_{n-2} + a_{n-3} = 5 $$两式相减得$a_n - 3a_{n-1} + 3a_{n-2} - a_{n-3} = 0 $，得到特征多项式为$ x^3 - 3x^2 + 3x - 1 = 0 $，即���$(x-1)^3 = 0$。故特征多项式有一个三重根1，设$a_n = (A_0 + A_1n + A_2n^2)1^n$。由题目给出条件可知$a_0 = 1, a_1 = 2, a_2 = 5 + 2a_1 - a_0 = 8$，联立方程组得：$$\\left\\{\\begin{aligned}A_0 = 1\\\\ A_0 + A_1 + A_2 = 2 \\\\ A_0 + 2A_1 + 4A_2 = 8\\end{aligned}\\right.$$解得$ A_0 = 1, A_1 = -3/2, A_2 = 5/2$，故$a_n = 1 - 1.5n + 2.5n^2$"
    },
    "4.5": {
        "(1)": "设$a_n$为由A、B、C、D组成的n位字符串，其中子串AB至少出现一次的字符串数目。考虑在n-1位字串后加上一位字符和在n-2位字串后加上两位字符的可能。在已经有子串AB出现过的n-1位字串后加入任何一个字母都满足要求，而在没有子串AB出现过的n-2位字串后加入AB可以满足要求。用递推公式表示：已有子串AB的n-1位字串有$a_{n-1}$个，而没有子串AB的n-2位字串有$4^{n-2} - a_{n-2}$个。则$a_n = 4a_{n-1} + 4^{n-2} - a_{n-2}$。这样讨论时，向没有AB子串的n-1位字串后加入字符形成满足要求的字串的情况已包含在在没有子串AB出现过的n-2位字串后加入AB的情况中，在已有子串AB出现过的n-2位字串后加入字符形成满足要求的字串的情况已包含在在已经有子串AB出现过的n-1位字串后加入字符的情况中。将公式转化为齐次线性递推式：$$a_n - 4a_{n-1} + a_{n-2} = 4^{n-2} \\\\ 4(a_{n-1} - 4a_{n-2} + a_{n-3}) = 4^{n-2} \\\\ a_n - 8a_{n-1} + 17a_{n-2} - 4a_{n-3} = 0$$故特征多项式为$C(x) = x^3 - 8x^2 + 17x - 4 = 0$，因式分解得$(x-4)(x^2- 4x + 1) = 0$，故有三个根$\\alpha_1 = 4, \\alpha_2 = 2+\\sqrt{3}, \\alpha_3 = 2 - \\sqrt{3}$。设$a_n = l_1\\alpha_1^n + l_2\\alpha_2^n+ l_3\\alpha_3^n$，已知$a_0 = 0, a_1 = 0, a_2 = 1, a_3 = 8$，联立方程组得：$$\\left\\{\\begin{aligned}l_1 + l_2 + l_3= 0\\\\ 4l_1 + (2+\\sqrt{3})l_2 + (2-\\sqrt{3})l_3 = 0\\\\ 16l_1 + (7 +4\\sqrt{3})l_2 + (7 -4\\sqrt{3})l_3 = 1 \\end{aligned}\\right.$$解得$ l_1 = 1, l_2 = -\\frac{1}{2} - \\frac{\\sqrt{3}}{3}, l_3 = -\\frac{1}{2} + \\frac{\\sqrt{3}}{3}$。故$$ a_n = 4^n + (-\\frac{1}{2} - \\frac{\\sqrt{3}}{3})(2+\\sqrt{3})^n + (-\\frac{1}{2} + \\frac{\\sqrt{3}}{3})(2-\\sqrt{3})^n$$"
    },
    "4.6": {
        "(1)": "已知原始汉诺塔问题，移动n个盘子需要$h(n) = 2^n-1$次。本题中，设移动n个盘子所需步骤为$a_n$。n为奇数和n为偶数的情况，只有移动到的柱子顺序有区别，故以n为奇数为例：首先将除n号盘子外其他盘子从A移动到B上，需要h(n-1)次，将n号盘子从A移动到C上，需要1次，将除n-1号、n-2号盘子之外的其他盘子从B移动到A上，需要h(n-3)次，将n-2号盘子从B移动到C上，需要1次，此时1到n-3号盘子均在A上，达到题目要求需要移动$a_{n-3}$次。故$a_n = 2^{n-1}-1 +1+2^{n-3} - 1 + 1 + a_{n-3} = a_{n-3} + 5*2^{n-3}$。变换为齐次线性常系数递推式：$$a_n = a_{n-3} + 5*2^{n-3}\\\\ 2a_{n-1} = 2a_{n-4} + 5*2^{n-3} $$两式相减得$a_n - 2a_{n-1}-a_{n-3} + 2a_{n-4} = 0 $。得到特征多项式为$C(x) = x^4 - 2x^3 - x  +2 = 0 $，因式分解得$(x-1)(x-2)(x^2 + x + 1) = 0$，有两个单根$\\alpha_1=1,\\alpha_2=2 $和一对共轭复根$\\alpha_{3,4}=-\\frac{1}{2} \\pm \\frac{\\sqrt{3}}{2}i = e^{\\pm \\frac{2\\pi}{3} i} $。设 $ a_n = A*1^n + B*2^n + C*\\cos\\frac{2n\\pi}{3} + D*\\sin\\frac{2n\\pi}{3}$。可知$a_0= 0, a_1 = 1, a_2 = 2, a_3 = 5$，联立方程组：$$\\left\\{\\begin{aligned}A + B + C = 0\\\\ A + 2B -\\frac{1}{2}C + \\frac{\\sqrt{3}}{2}D= 1\\\\ A + 4B -\\frac{1}{2}C - \\frac{\\sqrt{3}}{2}D = 2 \\\\ A+8B +C = 5\\end{aligned}\\right.$$解得$A=-\\frac{2}{3}, B = \\frac{5}{7}, C = -\\frac{1}{21}, D = \\frac{\\sqrt{3}}{7} $。$$ a_n = -\\frac{2}{3} + \\frac{5}{7}*2^n + -\\frac{1}{21}*\\cos\\frac{2n\\pi}{3} + \\frac{\\sqrt{3}}{7}*\\sin\\frac{2n\\pi}{3} $$代入$a_4 = 11$，验证正确。"
    },
    "4.7": {
        "(1)": "设使用k种字母组成长度为n的字符串，不允许相同字母连续出现3次的方案数为$a_n$。考虑至少出现一次连续3个相同字母的字符串数量，即为所有n位字符串数量$k^n$减去$a_n$：按首次出现连续3个相同字母的位置，在最后3个和在其他位置分为两类。首次出现在最后3个的情况，前n-3个字符不允许出现3个连续相同字母，同时最后3个的字母和第n-3个字母不可以相同，否则首次出现连续3个相同字母的位置不是最后三个位置，故最后3个字母有k-1种情况，这种情况下有$(k-1)a_{n-3}$种方案。首次出现在其他位置的情况，则为前n-1个字符组成的字串中少出现一次连续3个相同字母的情况，第n个字符为任意字母，故有$k(k^{n-1} - a_{n-1})$。故 $ a_n = k^n - (k-1)a_{n-3} - k(k^{n-1} - a_{n-1}) = ka_{n-1} - (k-1)a_{n-3}$。齐次线性常系数递推式为$a_n - ka_{n-1} + (k-1)a_{n-3} = 0$，特征多项式为$C(x) = x^3 - kx^2 + k-1 = 0$，因式分解为$(x-1)(x^2 - (k-1)x - (k-1)) = 0 $，根为$\\alpha_1 = 1, \\alpha_{2,3} = \\frac{k-1\\pm\\sqrt{(k-1)(k+3)}}{2}$。设$a_n = A\\alpha_1^n + B\\alpha_2^n + C\\alpha_3^n$。可知$a_1 = k, a_2 = k^2, a_3 = k^3 - k$，由此可以推出$a_0 = \\frac{k}{k-1}$联立方程：$$\\left\\{\\begin{aligned}A + \\frac{k-1+\\sqrt{(k-1)(k+3)}}{2}B +\\frac{k-1-\\sqrt{(k-1)(k+3)}}{2}C = k\\\\ A + (\\frac{k-1+\\sqrt{(k-1)(k+3)}}{2})^2B +(\\frac{k-1-\\sqrt{(k-1)(k+3)}}{2})^2C= k^2\\\\ A + B + C = \\frac{k}{k-1}\\end{aligned}\\right.$$，解得$A = 0, B = \\frac{k}{2}(\\frac{1}{k-1} + \\frac{1}{\\sqrt{(k-1)(k+3)}}), C=\\frac{k}{2}(\\frac{1}{k-1} - \\frac{1}{\\sqrt{(k-1)(k+3)}})$ $$ a_n= \\frac{k}{2}(\\frac{1}{k-1} + \\frac{1}{\\sqrt{(k-1)(k+3)}})(\\frac{k-1+\\sqrt{(k-1)(k+3)}}{2})^n + \\\\\\frac{k}{2}(\\frac{1}{k-1} - \\frac{1}{\\sqrt{(k-1)(k+3)}})(\\frac{k-1-\\sqrt{(k-1)(k+3)}}{2})^n $$"
    },
    "4.8": {
        "(1)": "根据课上内容可知$S_n= \\sum_{k=1}^{n}k^4$的特征多项式为$(x-1)^6 = 0$。设 $S_n = A_1\\binom{n}{1} + A_2\\binom{n}{2} + A_3\\binom{n}{3} + A_4\\binom{n}{4} + A_5\\binom{n}{5}$。$$S_1 = 1 = A_1\\\\ S_2 = 17 = 2 + A_2, A_2 = 15\\\\ S_3 = 1+16+81 = 98 = 3 + 15*3 + A_3, A_3 = 50\\\\ S_4 = 1+16+81+256 = 354 = 4 + 15*6 + 50*4 + A_4, A_4 = 60\\\\ S_5 = 354+625 = 979 = 5 + 15*10 + 50*10 + 60*5 + A_5, A_5 = 24$$故$$S_n = \\binom{n}{1} + 15\\binom{n}{2} + 50\\binom{n}{3} + 60\\binom{n}{4} + 24\\binom{n}{5}\\\\ =\\frac{1}{30}n(n+1)(2n+1)(3n^2+3n-1)$$"
    },
    "4.9": {
        "(1)": "根据是否选择n分为两类。若选择n，则n-1不被选择，在前n-2个数中选择k-1个，即f(n-2, k-1)。若不选择n，则在前n-1个数中选择k个，即f(n-1, k)。$$f(n, k) = f(n-2,k-1) + f(n-1, k)$$",
        "(2)": "考虑组合数$\\binom{n}{k} = \\binom{n-1}{k-1} + \\binom{n-1}{k}$，设$$f(n,k) = \\left\\{ \\begin{aligned}\\binom{n-k+1}{k}, n \\ge 2k-1\\\\ 0, n \\lt 2k-1\\end{aligned} \\right.$$当$n < 2k-1$时，可知选择k个数一定至少有两个数相邻，故f(n,k) = 0。对于$n\\ge 2k-1$的情况可归纳证明：$$n=1, k=1, f(1,1) = 1 = \\binom{1}{1}\\\\ n=2, k=1, f(2,1) = 2 = \\binom{2}{1}\\\\ n=2, k=2, f(2,2) = 0, n < 2k-1\\\\$$对于$f(n,k),n \\ge 3, n \\ge 2k-1$，由归纳法已证明$f(n-2, k-1) = \\binom{(n-2)-(k-1)+1}{k-1} = \\binom{n-k}{k-1}$，$f(n-1, k) = \\binom{(n-1)-k+1}{k} = \\binom{n-k}{k}$。$$f(n, k) = f(n-2, k-1) + f(n-1, k) \\\\= \\binom{n-k}{k-1} + \\binom{n-k}{k} \\\\= \\binom{n-k+1}{k}$$",
        "(3)": "当$n < 2k$时，选择k个数一定至少有两个数相邻，故g(n,k) = 0。当$n \\ge 2k$时，将情况分为两种：选择1号和不选择1号。若选择1号，则一定不选择2号和n号，即在3到n-1号中选择不相邻的k-1个，为f(n-3, k-1)。若不选择1号，则在2到n号中选择不相邻的k个，为f(n-1, k)。$$g(n, k) = f(n-3, k-1) + f(n-1, k)\\\\=\\binom{(n-3) - (k-1) + 1}{k-1} + \\binom{(n-1) - k + 1}{k}\\\\=\\binom{n-k-1}{k-1} + \\binom{n-k}{k}\\\\=\\frac{k}{n-k}\\binom{n-k}{k} + \\binom{n-k}{k}\\\\=\\frac{n}{n-k}\\binom{n-k}{k}$$则答案为$$g(n,k) = \\left\\{ \\begin{aligned}\\frac{n}{n-k}\\binom{n-k}{k}, n \\ge 2k\\\\ 0, n \\lt 2k\\end{aligned} \\right.$$"
    },
    "4.10": {
        "(1)": "设所有可能的铺砖方案数为$a_n$。分析可知，斜边长为2的三角形砖块斜边一定在路的边缘上，直角边长为1的三角形砖块斜边一定在路的内部。这条矩形路径沿着砖块的一部分边线，一定可以尽可能细地切分成矩形块（即令切块尽可能小，方砖一定独立作为一个切块），且切分方法唯一，考虑最后一个矩形块的形状：若为$1\\times1$的矩形块，则此矩形块有3种形态，一块方砖和沿两条对角线分别切分成两个三角形，则方案数为$3a_{n-1}$。若为$1\\times k，k>1$的矩形块，一定由两侧的2个直角边长为1的三角形砖块和中间的数个斜边长为2的三角形砖块组成，对于每个k，这个矩形块都有2种铺砖方案（上下翻转），则铺路方案数为$2a_{n-k}, 2 \\le k \\le n$，特别地，当$n = k$时，$a_0 = 1$才能使方案数增加2。则$$a_n = 3a_{n-1} + 2(a_{n-2} + a_{n-3} + a_{n-4} + ... + a_{0}), a_0 = 1\\\\ a_n = a_{n-1} + 2(a_{n-1} + a_{n-2} + ... + a_1 + a_0) \\\\ a_{n-1} = a_{n-2} + 2(a_{n-2} + a_{n-3} + ... + a_1 + a_0) \\\\$$两式相减得 $a_n-4a_{n-1}+a_{n-2} = 0$，特征多项式为$C(x) = x^2 - 4x + 1 = 0$，得到两个单根$\\alpha_1 = 2+\\sqrt3, \\alpha_2 = 2-\\sqrt3$。设$a_n = A\\alpha_1^n + B\\alpha_2^n$，已知$a_0 = 1, a_1 = 3$，联立方程组得：$$\\left\\{ \\begin{aligned}A + B = 1\\\\ (2+\\sqrt3)A + (2-\\sqrt3)B = 3\\end{aligned} \\right.$$解得$A = \\frac{3+\\sqrt3}{6}, B = \\frac{3-\\sqrt3}{6}$。$$a_n = \\frac{3+\\sqrt3}{6}(2+\\sqrt3)^n +\\frac{3-\\sqrt3}{6}(2-\\sqrt3)^n$$",
        "(2)": "设砖数的总和为$b_n$考虑最后一个矩形块的形状：若为$1\\times1$的矩形块，则此矩形块有3种形态，一块方砖和沿两条对角线分别切分成2块三角形砖，则所有方案的总砖数为$3b_{n-1}+ 5a_{n-1}$。若为$1\\times k，k>1$的矩形块，一定由两侧的2个直角边长为1的三角形砖块和中间的数个斜边长为2的三角形砖块，总共$k + 1$个砖块组成，对于每个k，这个矩形块都有2种铺砖方案（上下翻转），则所有方案总砖数为$2(b_{n-k} + (k+1)a_{n-k}), 2 \\le k \\le n$，特别地，当$n = k$时，$b_0 = 0$。则$$b_n = 3b_{n-1} + 5a_{n-1} + 2(\\sum_{k=2}^{n}b_{n-k} + \\sum_{k=2}^{n}(k+1)a_{n-k})\\\\ b_n = 3b_{n-1} + 2(b_{n-2} + b_{n-3} + ... + b_1 + b_0) + 5a_{n-1} + 2(3a_{n-2} + 4a_{n-3}+...+(n+1)a_0) \\\\ b_{n-1} = 3b_{n-2} + 2(b_{n-3} + b_{n-4} + ... + b_1 + b_0) + 5a_{n-2} + 2(3a_{n-3} + 4a_{n-4}+...+na_0)$$两式相减得$$b_n - 4b_{n-1} + b_{n-2} = 5a_{n-1} + a_{n-2} + 2(a_{n-3} + ... + a_0)$$已知$a_n = 3a_{n-1} + 2(a_{n-2} + a_{n-3} + a_{n-4} + ... + a_{0})$代入式中得$$b_n - 4b_{n-1} + b_{n-2} = a_n + 2a_{n-1} - a_{n-2}$$已知$a_n-4a_{n-1}+a_{n-2} = 0$代入式中得$$b_n - 4b_{n-1} + b_{n-2} = 2(a_n - a_{n-1}) = \\frac{2\\sqrt3}{3}((2+\\sqrt3)^n - (2-\\sqrt3)^n)$$。$\\alpha_1 = 2+\\sqrt{3}$和$\\alpha_2=2-\\sqrt{3}$是特征方程的1重根，m=1，p=0，设特解为$(An)\\alpha_1^n + (Cn)\\alpha_2^n$。$b_n$的形式是$(An)\\alpha_1^n + (Cn)\\alpha_2^n + B\\alpha_1^n + D\\alpha_2^n = (An+B)\\alpha_1^n + (Cn+D)\\alpha_2^n$。$b_0 = 0, b_1 = 5, b_2 = 36, b_3 = 199$，联立方程组得：$$\\left\\{\\begin{aligned}B + D = 0\\\\ (2+\\sqrt3)(A+B) + (2-\\sqrt3)(C+D) = 5\\\\ (2+\\sqrt3)^2(2A+B) + (2-\\sqrt3)^2(2C+D) = 36\\\\ (2+\\sqrt3)^3(3A+B) + (2-\\sqrt3)^3(3C+D) = 199\\end{aligned}\\right.解得$A = \\frac{\\sqrt3}{3} + \\frac{2}{3}, B = \\frac{\\sqrt3}{18}, C = \\frac{2}{3} - \\frac{\\sqrt3}{3}, D = -\\frac{\\sqrt3}{18}$。$$b_n = ((\\frac{\\sqrt3}{3} + \\\\frac{2}{3})n+\\\\frac{\\sqrt3}{18})(2+\\sqrt3)^n + ((\\frac{2}{3} - \\\\frac{\\sqrt3}{3})n-\\frac{\\sqrt3}{18})(2-\\sqrt3)^n$$"
    }
}