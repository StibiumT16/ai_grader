# 组合数学作业1-进阶B
#### Ch1-1B-14

### T1.25
`题目` 设$n, r$是正整数，令$S$是由 $\{1, 2, ⋯ , n\}$ 的全体$r$元子集构成的集合，证明$\sum_{A \in S} \min A = \binom{n+1}{r+1}$

`Sol.`
引理: $$\binom{r}{r} + \binom{r+1}{r} + \dots + \binom{n}{r} = \binom{n+1}{r+1}$$
证明：由杨辉三角有：$\binom{n}{r} + \binom{n}{r-1} = \binom{n+1}{r}$
故有$$LHS = \binom{r}{r} + \binom{r+1}{r} + \dots + \binom{n}{r} \\ = \binom{r+1}{r+1} + \binom{r+1}{r} + \dots + \binom{n}{r} \\ = \binom{r+2}{r+1} + \binom{r+2}{r} + \dots + \binom{n}{r} \\ = ... = \binom{n}{r+1} + \binom{n}{r} = \binom{n+1}{r+1} = RHS$$ 
引理证毕

回到本问题，我们考虑每个数在$\min A$中出现的次数，
例如，若$\min A = 1$，此时$1 \in A$，剩余的数在2~n中选取r-1个，次数为$\binom{n-1}{r-1}$

类似地，若$\min A = 2$，剩余的数在3~n中选取r-1个，次数为$\binom{n-2}{r-1}$，......，$n-r+1$的次数为$\binom{r-1}{r-1}$
因此根据引理，最终答案:$$\begin{aligned} & 1 \cdot \binom{n-1}{r-1} + 2 \cdot \binom{n-2}{r-1} + \dots + (n - r + 1) \cdot \binom{r-1}{r-1} \\ =& [\binom{n-1}{r-1} + \binom{n-2}{r-1} + \dots + \binom{r-1}{r-1}] \\ &+ [\binom{n-2}{r-1} + \dots + \binom{r-1}{r-1}] \\ &+ \dots +[\binom{r}{r-1} + \binom{r-1}{r-1}] + [\binom{r-1}{r-1}] \\ = & \binom{n}{r} + \binom{n-1}{r} + \dots + \binom{r+1}{r} + \binom{r}{r} \\= &\binom{n+1}{r+1}\end{aligned}$$
证毕

`评价` 主要考察问题的转化变形以及组合恒等式，难度中等，个人认为是一道好题

### T1.26
`题目` 对 26 个小写英文字母作全排列，要求单词 dog 出现在排列中，并且字母 p 在字母 q 前面、dog 在 p 和 q 之间，求满足上述条件的的排列方案数

`Sol.`
方法一 首先将‘dog’视为一个整体，相当于一共有24个字母，全排列有$24!$种
再考虑顺序，p在dog前，dog在q前，三者的顺序种类总共有$3!$种
故满足条件的方案数为$\frac{24!}{3!}$

方法二 也可考虑确定了p，dog，q的顺序后，使用剩下21个字母进行插空，第一个字母可以放在4个位置，第二个字母可以放在5个位置,......,第21个字母可以放在24个位置，故方案数为$4\times5\times \dots \times 24$

`评价` 比较综合的排列组合问题，考察了整体法（将dog视为整体）、倍缩法（即p、dog、q的顺序确定），考察的知识点比较综合，难度中等偏下


### T1.27
`题目` 有 100 个英文字母，其中 a、b、c、d、e 各有 1 个，f、g、h、i、j 各有 19 个．现将这 100 个字母排成一列，要求字母 a、b、c、d、e 按照字母表顺序排列，并且 a、b 之间相隔至少 3 个字母，b、c 之间相隔至少 5 个字母，c、d 之间相隔至少 7 个字母，d、e 之间相隔至少 9 个字母．求满足上述要求的排列方案数

`Sol.`
首先考虑abcde形成的6个空（包括两端），考虑将其余字母插到这些空位中，先忽略字母是什么只考虑插空的方案，转化为不定方程的解的问题：$x_1+x_2+x_3+x_4+x_5+x_6 = 95, x_1 \geq 0, x_2 \geq 3, x_3 \geq 5, x_4 \geq 7, x_5 \geq 9, x_6 \geq 0$
等价于$x_1+x_2+x_3+x_4+x_5+x_6 = 71, x_i \geq 0 $，不定方程解的个数为 $\binom{76}{5}$
而f-j这些字母多重全排列的方案为：$\frac{95!}{(19!)^5}$
故总方案数为$\binom{76}{5}\frac{95!}{(19!)^5}$

`评价` 也是一道比较综合的排列组合问题，考察了隔板法和多重全排列，比较综合，难度中等偏下


### T1.28
`题目` 从不定方程非负整数解数目的视角，证明下列等式成立：$$\binom{n+m}{m} = \sum_{k=0}^n\binom{k+m-1}{m-1}, n\geq0, m\geq1$$
`Sol.`
RHS表示不定方程$x_1+...+x_m=k, x_{i} \geq 0$ 的非负整数解个数，其中$k$的取值为0~n
LHS则表示不定方程$x_1+...+x_m+x_{m+1}=n, x_{i} \geq 0$的非负整数解个数
对于LHS所对应的不定方程，我们可以分别枚举$x_{m+1}$的可能取值($x_{m+1} \in [0, n]$)，令 $k = n - x_{m+1}$, 再计算剩余部分$x_1+...+x_m = k = n - x_{m+1} \in [0, n]$的方案数，对不同$k$的取值求和，即可得到RHS

`评价` 比较好想的组合构造，但是需要深入理解不定方程的非负整数解方案数的本质，个人认为难度适中

### T1.29
`题目` 从 −5, −4, −3, −2, −1, 1, 2, 3, 4 这 9 个数中选出 4 个，要求其乘积为正数
(1) 若选择的数字互不相同，求方案数；
(2) 若选择的数字允许相同，求方案数．

`Sol.`
(1) 分别考虑4正0负，2正2负，0正4负，方案分别为$\binom{4}{4}=1, \binom{4}{2}\binom{5}{2}=60, \binom{5}{4}=5$，总方案数为66
(2) 同样考虑三种情况，例如对于4正0负，转化为可重组合问题，相当于4个相同的球投到1，2，3，4四个盒子中，每个盒子球的数目不限，方案数为$\binom{4+4-1}{4}=35$；也可从不定方程$x_1+x_2+x_3+x_4=4$的非负整数解的角度考虑
类似地对于2正2负以及0正4负的情况，方案数分别为$\binom{4+2-1}{2}\binom{5+2-1}{2}=150$和$\binom{5+4-1}{4}=70$
故总方案数为255

`评价` 第一问很简单，就是考察简单的组合问题只不过需要一点分类讨论；第二问则引入了可重组合问题，如果想到了也比较简单，整体难度中等偏下

### T1.30
`题目` 求不定方程 $xyz=1000000$ 的整数解数目

`Sol.` 
$xyz = 10^6 = 2^6 \cdot 5^6$
先假设三个变量都为正的情况，假设 $x = 2^{a_1} \cdot 5^{b_1}, y = 2^{a_2} \cdot 5^{b_2}, z = 2^{a_3} \cdot 5^{b_3}$， 故有$a_1+a_2+a_3=6, b_1+b_2+b_3=6$
这两个不定方程非负整数解均为$\binom{6+3-1}{3-1}=28$，根据乘法原理，xyz均为正数时原方程解的个数为$28*28 = 784$
再考虑xyz中包含两个负数的情况，符号的方案有$\binom{3}{2}=3$种
故原方程整数解数目为 $(3 + 1) * 784 = 3136$

`评价` 中等难度，问题的转换（即分解因数）上有一点点难度需要转个弯，想到之后就是比较简单的组合了

### T1.31
`题目` 设 $n$ 是正整数，证明 $\sum_{k=1}^n \frac{k \cdot P(n, k)}{n^{k+1}} = 1$

`Sol.`
先对原式进行变形：
$$\begin{aligned}
\sum_{k=1}^n \frac{k \cdot P(n, k)}{n^{k+1}} &= 1 \\ \iff \sum_{k=1}^n \frac{k \cdot P(n, k) \cdot n^{n-k}}{n^{n+1}} &= 1\\ \iff \sum_{k=1}^n k \cdot P(n, k) \cdot n^{n-k} &= n^{n+1}
\end{aligned}$$
考虑等式右边，可以表示为由1～n构成的长为n+1的序列（串），记为$\{a_0, a_1,\dots,a_n\}$
对于其中的每一个序列，由于序列长为n+1，但只有n个元素，根据**抽屉原理，存在至少一个元素重复出现**
我们假设从左边$a_1$开始，第一次重复出现的元素为$a_k$（即$a_0,...,a_{k-1}$互不相同，而$a_k$与其中之一相同），因此$a_0,...,a_{k-1}$的方案为$P(n,k)$，$a_k$与其中之一相同，选其一方案数为$k$，剩下的n-k个位置 ($a_{k+1},...,a_{n}$) 任意取，方案为$n^{n-k}$
枚举上述的k(1~n)，即为等式左边，因此得证

`评价` 个人认为是这套题中最难的一道题，想了很久才想到可以利用抽屉原理进行构造重复元素从而进行组合解释

### T1.32
`题目` 设 $a_1a_2...a_n$是{1, 2, ⋯ , n}的一个排列，我们将排在$a_i$后面且比$a_i$小的数的个数称为$a_i$的中介数。例如，对于排列364521，4的中介数为2．求{1, 2, ⋯ , 8}的所有排列中，满足8的中介数为2、7的中介数为3、5的中介数为3的排列方案数

`Sol.`
由于8是这个排列中最大的数，其中介数为2，因此8位于排列的倒数第三位
而除了8之外最大的数为7且其中介数为3，因此7不能位于8之后（否则中介数至多为1），而7、8之间应当有且仅有一个更小的数
目前的格局为:xxx7x8xx
显然5只能位于7之前（如果位于7之后，其中介数至多为2），我们枚举6的位置：
* 如果6位于7的后面（即第5、7、8位中），此时5必须位于第二位，才能在第3位、第5、7、8位中的两位中获取3的中介数，此时格局为:x5x7y8yy，其中y表示可能为6的位置，方案数为：$3 * 4!=72$
* 若6位于第3位，则5只能位于第2位才能保证其中介数为3，此时格局为：x567x8xx，方案数为$4!=24$
* 若6位于第1位或第2位，则5只能位于第3位才能保证其中介数为3，此时格局为:yy57x8xx，其中y为6可能出现的位置，此时方案数为$2*4!=48$
  
综上所述，总方案数为144

`评价` 根据中介数的定义先确定7、8的位置，再针对5、6的位置进行讨论即可，稍微复杂一点但整体难度不算高，中等吧


### T1.33
`题目` 有m个不同的盒子，将r个相同的小球放入其中的n个盒子中，要求这n个盒子互不相邻且每盒至少包含k个球（$r\geq nk, m\geq 2n-1$）．求满足要求的放球方案数

`Sol.`
首先计算选取不相邻的n个盒子的方案数，可以由减下标法计算得到，方案数为$\binom{m-n+1}{n}$
再考虑r个相同小球放到这n个盒子的方案数，要求每个盒子至少包含k个球，可以视为不定方程$x_1+...+x_n=r,x_i>=k$的整数解个数，等价于不定方程$x_1'+...+x_n'=r - n*k$非负整数解个数，计算为$\binom{r - n * k + n - 1}{n - 1} = \binom{r-n*(k-1)-1}{n-1}$
故总方案数为$\binom{m-n+1}{n}\binom{r-n*(k-1)-1}{n-1}$

`评价` 考察不相邻排列&不定方程，中等偏下难度

### T1.34
`题目` 有n个小写英文字母，其中第k种字母的出现次数为$a_k$，保证$\sum_{k=1}^{26}a_k=n$．现使用这些字母组成一个字符串，要求不能为回文串（即逆序后与原串相同的字符串）．通过讨论各$a_i$的奇偶性，求符合要求的字符串数目．

`Sol.`
引理：当且仅当出现次数为奇数的字母至多有一个时，才能构成回文串
证明：当回文串长度为偶数时，要求左右对称，所以每个字母的出现次数必为偶数；当回文串长度为奇数时，有且仅有一个字母可以作为中心字母，将其删去后剩下的部分仍为回文串，可以转化为上述长度为偶数的情况，此时仅有中心字母的出现次数为奇数

基于引理，我们可以进行如下分类讨论：
* 当出现次数为奇数的字母多于两个时，此时无法构成回文串，所有串均合法，数目可由多重排列得到:$\frac{n!}{a_1!a_2!...a_{26}!}$
* 当所有字母出现次数均为偶数时，对于回文串我们只考虑串的前一半（后一半可以由前一半翻转得到），回文串的方案数也可以由多重排列计算：$\frac{(n/2)!}{(a_1/2)!(a_2/2)!...(a_{26}/2)!}$
因此合法方案数：$\frac{n!}{a_1!a_2!...a_{26}!} - \frac{(n/2)!}{(a_1/2)!(a_2/2)!...(a_{26}/2)!}$
* 当只有一个字母的出现次数为奇数时，我们将其记为$a_t$，该字母必须取一个放在中心位置上，故回文串数目：$\frac{((n-1)/2)!}{(a_1/2)!...((a_t-1)/2)!...(a_{26}/2)!}$
故此时合法方案数：$\frac{n!}{a_1!a_2!...a_{26}!}-\frac{((n-1)/2)!}{(a_1/2)!...((a_t-1)/2)!...(a_{26}/2)!}$

`评价` 主要的难点在于回文串的性质（即引理部分），剩下的分类讨论就是比较简单的多重排列，难度中等

### T1.35
`题目` 若将一个三阶魔方的角块和棱块全部拆下，然后再随机拼回，则魔方能复原的概率为1/12. 根据这一条件，求三阶魔方的合法状态(即能复原的状态)数目。

`Sol.`
三阶魔方的26个块中包含8个角块，12个棱块，其中每个每个角块有3种旋转状态，而每个棱块有2种不同的方向。
因此对于角块，排列数为$8!$，朝向为$3^8$；对于棱块，排列数为$12!$，朝向为$2^{12}$，故总状态数为$8!\cdot3^8\cdot12!\cdot2^{12}$
依题意，合法状态数为该值/12，即$8!\cdot 3^7\cdot12!\cdot2^{10}$

`评价` 主要的难点在于魔方这一场景的建模，想清楚了棱、角的构造就是比较简单的排列问题了，难度中等吧

### T1.36
`题目` 某份试卷中有一道包含四个选项A,B,C,D的选择题，共有147位同学交卷．现需要统计选择了每个选项的同学人数．例如，统计结果可能是 {A:100, B:0, C:42, D:5}.
(1) 若所有同学都回答了此题，求可能出现的统计结果数目．
(2) 若每位同学均可能没有回答此题，求可能出现的统计结果数目．
(3) 假设此题的正确答案是C，为了提高平均分，规定若做对此题的人不足交卷同学的一半，则此题不算分．每位同学均可能没有回答此题，求使此题算分的统计结果数目．

`Sol.`
(1) 等价于求不定方程$x_1+x_2+x_3+x_4=147,x_i\geq0$的整数解的个数，为$\binom{147+4-1}{4-1}=\binom{150}{3}$
(2) 方法一：基于第(1)问，可以枚举回答了题目的人数：$\sum_{i=0}^{147}\binom{i+3}{3}=\binom{151}{4}$(由T1.25引理可得)
方法二：也可以将未答题的人数记为$x_5$，则答案为不定方程$x_1+x_2+x_3+x_4+x_5=147,x_i\geq0$的整数解的个数，计算为$\binom{147+5-1}{5-1}=\binom{151}{4}$
(3) 依题意，要求$x_3\geq74$，令$x_3'=x_3-74$，等价于不定方程$x_1+x_2+x_3'+x_4+x_5=73$的非负整数解个数，计算为$\binom{73+5-1}{5-1}=\binom{77}{4}=1353275$

`评价` 主要考察的是不定方程整数解的变形，难度中等